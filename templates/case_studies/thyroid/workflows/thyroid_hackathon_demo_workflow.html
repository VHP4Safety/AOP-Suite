{% extends "base.html" %}

{% block content %}
<h1 style="color: white;">Thyroid Case Demo Workflow for the Hackthon</h1>
<br>

<div class="container">
  <section>
      <p style="color: white;">Select compounds from the table:</p>
      <table class="table table-bordered table-striped" id="compound_table" style="background-color: white;">
          <thead>
              <tr>
                  <th>Select</th>
                  <th>Compound</th>
                  <th>SMILES</th>
              </tr>
          </thead>
          <tbody>
              <!-- Rows will be dynamically populated -->
          </tbody>
      </table>
      <button id="submit_selection" class="btn btn-primary" style="margin-top: 10px;">Confirm selection</button>
      <p style="color: white; margin-top: 20px;">Selected compounds and SMILES:</p>
      <p id="selected_info" style="color: lightblue; font-weight: bold;">None</p>
  </section>
</div>

<style>
  /* Increase the size of checkboxes */
  .compound-checkbox {
      align-self: center;
      text-align: center;
  }

  /* Make SMILES strings smaller */
  #compound_table td:nth-child(3) {
      font-size: 0.8em; /* Reduce font size for SMILES column */
  }
</style>




<!--- Below is the part for getting a table with tick marks
<script>
  $(document).ready(function () {
    // Fetch KE options and populate KE dropdown sorted by KE Label
    $.getJSON("/get_dummy_data")
      .done(function (data) {

        // Populate KE ID dropdown
        const table = $("#table_id");
        table.empty();
        data.forEach((option) => {
          table.append(
            `<option value="${option.Compound}" data-title="${option.SMILES}">${option.Compound} - ${option.SMILES}</option>`,
            `<option value="${option.KElabel}" data-title="${option.KEtitle}">${option.KElabel} - ${option.KEtitle}</option>`,
          );
        });
      })
      .fail(function () {
        console.error("Failed to load KE options"); // Debug log
        $("#message").text("Failed to load Key Events").css("color", "red");
      });
    });
</script>
---> 


<script>
  // Fetch the list of compounds with their SMILES from the server
  $.getJSON("/get_compounds", function (data) {
      console.log(data); // Debug log
      const tableBody = $("#compound_table tbody");
      tableBody.empty();
      data.forEach((option, index) => {
          tableBody.append(`
              <tr>
                  <td><input type="checkbox" class="compound-checkbox" data-term="${option.Term}" data-smiles="${option.SMILES}"></td>
                  <td>${option.Term}</td>
                  <td>${option.SMILES}</td>
              </tr>
          `);
      });
  });

  // Listen for changes in checkbox selection and update the selected list
  $("#submit_selection").on("click", function () {
      const selectedCompounds = [];
      $(".compound-checkbox:checked").each(function () {
          const term = $(this).data("term");
          const smiles = $(this).data("smiles");
          selectedCompounds.push(`${term}: ${smiles}`);
      });
      
      const selectedText = selectedCompounds.length > 0 ? selectedCompounds.join(", ") : "None";
      console.log("Selected compounds:", selectedText); // Debug log
      $("#selected_info").text(selectedText);
  });
</script>

{% endblock %}
